
# Изменение версии виртуальной аппаратуры в OVA для совместимости с ESXi 5.0

Данная инструкция поможет изменить версию виртуальной аппаратуры в OVA-файле для обеспечения совместимости с VMware ESXi 5.0, когда исходная версия не поддерживается этой платформой.

## Предварительные требования

- **7-Zip** или **WinRAR** для работы с архивами
- **Notepad++** или другой текстовый редактор
- Исходный OVA-файл, который необходимо конвертировать

## Пошаговая инструкция

### Шаг 1: Распаковка OVA-файла

1. Установите **7-Zip** или **WinRAR**, если не установлены
2. Щелкните правой кнопкой мыши на OVA-файле
3. Выберите **«Распаковать здесь»** (или аналогичную команду)
4. После распаковки вы получите следующие файлы:
   - `.ovf` - файл конфигурации виртуальной машины
   - `.vmdk` - виртуальный диск
   - `.mf` - файл манифеста (может отсутствовать)

### Шаг 2: Изменение версии виртуальной аппаратуры в OVF-файле

1. Откройте файл с расширением `.ovf` в текстовом редакторе
2. Найдите строку с тегом `VirtualSystemType`:
   ```xml
   <vssd:VirtualSystemType>vmx-XX</vssd:VirtualSystemType>
   ```
3. Замените значение на версию, совместимую с ESXi 5.0:
   ```xml
   <vssd:VirtualSystemType>vmx-08</vssd:VirtualSystemType>
   ```
   или
   ```xml
   <vssd:VirtualSystemType>vmx-09</vssd:VirtualSystemType>
   ```

4. Сохраните изменения в файле

### Шаг 3: Обновление файла манифеста (.mf)

Если присутствует файл с расширением `.mf`:

1. Откройте **PowerShell** в папке с распакованными файлами
2. Выполните команду для вычисления новой контрольной суммы:
   ```powershell
   Get-FileHash -Algorithm SHA1 "ваш_файл.ovf" | Format-List
   ```
3. Скопируйте полученный хеш (значение в поле `Hash`)
4. Откройте файл `.mf` в текстовом редакторе
5. Найдите строку с контрольной суммой для OVF-файла:
   ```
   SHA1(ваш_файл.ovf)= старый_хеш
   ```
6. Замените старый хеш на новый
7. Сохраните файл

### Шаг 4: Пересборка OVA-файла

1. Выделите все необходимые файлы:
   - `.ovf` (обновленный)
   - `.vmdk`
   - `.mf` (если был обновлен)

2. Щелкните правой кнопкой мыши на выделенных файлах
3. Выберите **7-Zip → Добавить к архиву...**
4. Настройте параметры архива:
   - **Формат архива**: `tar`
   - **Имя архива**: `ваш_файл_esxi5.ova`
5. Нажмите **OK** для создания архива

### Шаг 5: Импорт в ESXi 5.0

Теперь обновленный OVA-файл готов к импорту в VMware ESXi 5.0 через:
- vSphere Client
- Web Client
- Командную строку

## Совместимые версии виртуальной аппаратуры

| Версия | Совместимость |
|--------|----------------|
| vmx-08 | ESXi 5.0, 5.1 |
| vmx-09 | ESXi 5.0, 5.1 |
| vmx-11 | ESXi 6.0+ |

## Примечания

- Данная инструкция предназначена для пользователей Windows
- Для Linux/macOS используйте команды `tar` для работы с архивами
- Всегда создавайте резервную копию исходного OVA-файла
- После импорта проверьте работу виртуальной машины

## Устранение проблем

**Проблема**: Ошибка проверки целостности при импорте
**Решение**: Убедитесь, что контрольная сумма в `.mf` файле соответствует хешу OVF-файла

**Проблема**: Виртуальная машина не запускается
**Решение**: Попробуйте использовать версию `vmx-07` или `vmx-08`
