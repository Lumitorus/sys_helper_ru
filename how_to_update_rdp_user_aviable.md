# Инструкция по настройке RDP подключения и RemoteApp

Это руководство поможет вам активировать возможность подключения по RDP (Remote Desktop Protocol) к компьютерам под управлением "домашних" версий Windows (7, 8, 10, 11) и организовать доступ к отдельным приложениям через RemoteApp.

## Содержание

1.  [Необходимые инструменты](#необходимые-инструменты)
2.  [Активация многопользовательского RDP (RDP Wrapper)](#активация-многопользовательского-rdp)
3.  [Создание и настройка RemoteApp (RemoteApp Tool)](#создание-и-настройка-remoteapp)
4.  [Проверка работоспособности](#проверка-работоспособности)
5.  [Ссылки и источники](#ссылки-и-источники)

---

### Необходимые инструменты

1.  **RDP Wrapper Library** - позволяет обойти ограничения "домашних" версий Windows и активировать многопользовательский RDP.
    *   Оригинальный репозиторий: [https://github.com/stascorp/rdpwrap](https://github.com/stascorp/rdpwrap)
    *   Ссылка для скачивания последней версии: [Releases · stascorp/rdpwrap](https://github.com/stascorp/rdpwrap/releases) (рекомендуется `RDPWrap-v1.6.2.zip`)

2.  **RemoteApp Tool** - утилита для создания и управления RemoteApp-приложениями, а также генерации RDP-файлов и MSI-установщиков для клиентов.
    *   Оригинальный репозиторий: [https://github.com/kimmknight/remoteapptool](https://github.com/kimmknight/remoteapptool)
    *   Ссылка для скачивания последней версии: [Releases · kimmknight/remoteapptool](https://github.com/kimmknight/remoteapptool/releases) (рекомендуется `RemoteApp.Tool.6100.zip`)

### Активация многопользовательского RDP

Для работы RemoteApp необходимо, чтобы на хосте (вашем компьютере) был активирован и работал RDP-сервер. RDP Wrapper решает эту задачу.

1.  **Скачайте и распакуйте** архив `RDPWrap-v1.6.2.zip`.
2.  Запустите файл **`install.bat`** от имени Администратора (щелкните правой кнопкой мыши -> "Запуск от имени администратора").
3.  Дождитесь завершения установки. Если процесс запросит разрешение брандмауэра — разрешите.
4.  После установки запустите **`RDPConf.exe`** (также от имени администратора).
5.  В открывшемся окне убедитесь, что все индикаторы зеленые:
    *   **Listener state** - `Listening [fully supported]`
    *   **Service state** - `Running`
    *   **Wrapper state** - `Installed`

> **⚠️ ВАЖНО: Если индикатор `Listener state` желтый или красный (`[not supported]`)**
>
> Это означает, что версия вашего файла `termsrv.dll` пока не поддерживается текущим конфигурационным файлом `rdpwrap.ini`. Решение:
>
> 1.  Откройте Командную строку (cmd) от имени Администратора.
> 2.  Остановите службу: `net stop termservice`
> 3.  Перейдите в папку установки RDP Wrapper (по умолчанию `C:\Program Files\RDP Wrapper`).
> 4.  Переименуйте старый файл `rdpwrap.ini` (например, в `rdpwrap.ini.old`).
> 5.  Скачайте актуальный файл `rdpwrap.ini` (например, из [этого обсуждения](https://github.com/stascorp/rdpwrap/issues/1379) или с сайта [rdpwrap.com](https://rdpwrap.com/)).
> 6.  Скопируйте новый `rdpwrap.ini` в папку RDP Wrapper.
> 7.  Запустите службу снова: `net start termservice`
> 8.  Снова проверьте статус в `RDPConf.exe`.

### Создание и настройка RemoteApp

После успешной настройки RDP Wrapper можно приступать к созданию RemoteApp-приложений.

1.  **Скачайте и распакуйте** архив `RemoteApp.Tool.6100.zip`.
2.  Запустите **`RemoteAppTool.exe`** от имени Администратора.
3.  В главном окне программы вы увидите список уже установленных программ. Чтобы добавить новое приложение, нажмите на плюс **`+ New`** или перейдите в меню `Edit -> New App`.

    

4.  В открывшемся окне укажите параметры приложения:
    *   **Name** - имя приложения, которое будет видеть пользователь.
    *   **Path** - полный путь к исполняемому файлу приложения (например, `C:\Windows\system32\notepad.exe`).
    *   **Alias** - короткое имя (псевдоним).
    *   При необходимости укажите иконку, аргументы командной строки и ассоциации файлов.

    

5.  После настройки приложение появится в общем списке. Выделите его и перейдите на вкладку **`Client Experience`**.

6.  На вкладке `Client Experience` вы можете сгенерировать файлы для подключения клиентов:
    *   **RDP File** - создает стандартный RDP-файл. При его запуске откроется только выбранное приложение, а не весь рабочий стол.
    *   **MSI Package** - создает установочный MSI-пакет (требует установленного [WiX Toolset](https://wixtoolset.org/)). После установки пакета на клиентском ПК ярлык приложения появится в меню "Пуск".

    

7.  Передайте сгенерированный RDP-файл или MSI-пакет пользователю.

### Проверка работоспособности

1.  **На хосте:** Убедитесь, что вы можете подключиться к своему же компьютеру через `mstsc.exe` (Подключение к удаленному рабочему столу), используя адрес `127.0.0.2`.
2.  **На клиенте:**
    *   Скопируйте RDP-файл на клиентский компьютер.
    *   Дважды щелкните по нему, чтобы запустить подключение.
    *   Введите учетные данные пользователя хоста.
    *   Если все настроено правильно, должно открыться только выбранное приложение (например, Блокнот), а не весь рабочий стол.

### Ссылки и источники

*   **RDP Wrapper Library:** [Официальный репозиторий на GitHub](https://github.com/stascorp/rdpwrap)
*   **RemoteApp Tool:** [Официальный репозиторий на GitHub](https://github.com/kimmknight/remoteapptool)
*   **Руководство пользователя RemoteApp Tool:** [How to create a RemoteApp and use it on another computer](https://github.com/kimmknight/remoteapptool/wiki/Create-a-RemoteApp-and-use-it-on-another-computer)
*   **Актуальные конфиги для RDP Wrapper:** [Обсуждение #1379](https://github.com/stascorp/rdpwrap/issues/1379)
